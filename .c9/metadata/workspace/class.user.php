{"filter":false,"title":"class.user.php","tooltip":"/class.user.php","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":43,"column":2},"action":"insert","lines":["<?php","include('class.password.php');","class User extends Password{","    private $db;","\t","\tfunction __construct($db){","\t\tparent::__construct();","\t","\t\t$this->_db = $db;","\t}","\tpublic function is_logged_in(){","\t\tif(isset($_SESSION['loggedin']) && $_SESSION['loggedin'] == true){","\t\t\treturn true;","\t\t}\t\t","\t}","\tprivate function get_user_hash($username){\t","\t\ttry {","\t\t\t$stmt = $this->_db->prepare('SELECT password FROM blog_members WHERE username = :username');","\t\t\t$stmt->execute(array('username' => $username));","\t\t\t","\t\t\t$row = $stmt->fetch();","\t\t\treturn $row['password'];","\t\t} catch(PDOException $e) {","\t\t    echo '<p class=\"error\">'.$e->getMessage().'</p>';","\t\t}","\t}","\t","\tpublic function login($username,$password){\t","\t\t$hashed = $this->get_user_hash($username);","\t\t","\t\tif($this->password_verify($password,$hashed) == 1){","\t\t    ","\t\t    $_SESSION['loggedin'] = true;","\t\t    return true;","\t\t}\t\t","\t}","\t","\t\t","\tpublic function logout(){","\t\tsession_destroy();","\t}","\t","}","?>"],"id":1}]]},"ace":{"folds":[],"scrolltop":22,"scrollleft":0,"selection":{"start":{"row":43,"column":2},"end":{"row":43,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":0,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1468222665409,"hash":"1e025f9d4deea8c55fa8afe16c00ffb622c4176d"}